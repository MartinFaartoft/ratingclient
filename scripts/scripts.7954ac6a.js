"use strict";angular.module("ratingClient",["ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider","$httpProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/ratinglist/:gameType",{templateUrl:"views/ratinglist.html",controller:"RatinglistCtrl"}).when("/players",{templateUrl:"views/players.html",controller:"PlayersCtrl"}).when("/players/:playerId",{templateUrl:"views/playerdetails.html",controller:"PlayerdetailsCtrl"}).otherwise({redirectTo:"/"}),b.interceptors.push("authInterceptor")}]).constant("baseUrl","https://ratinglist.herokuapp.com"),angular.module("ratingClient").controller("IndexCtrl",["$http","$scope","$route","$routeParams","authService","baseUrl",function(a,b,c,d,e,f){b.auth=e,b.login=function(){e.login(b.user.username,b.user.password),b.user={}},b.logout=function(){e.logout()},b.createPlayer=function(){var b=f+"/players/";a.post(b,{name:"SomeName"}).success(function(){window.alert("We are logged in!")})}}]),angular.module("ratingClient").controller("MainCtrl",function(){}),angular.module("ratingClient").factory("authService",["$http","baseUrl","$window",function(a,b,c){var d=Boolean(window.sessionStorage.token),e=c.sessionStorage.token?c.jwt_decode(window.sessionStorage.token):{},f=function(d,e){var f=this,g=b+"/api-token-auth/";a.post(g,{username:d,password:e}).success(function(a){c.sessionStorage.token=a.token,f.user=window.jwt_decode(a.token),f.isLoggedIn=!0}).error(function(a,b){c.alert(b)})},g=function(){window.sessionStorage.removeItem("token"),this.user={},this.isLoggedIn=!1};return{isLoggedIn:d,user:e,login:f,logout:g}}]),angular.module("ratingClient").factory("authInterceptor",["$rootScope","$q","$window",function(a,b,c){return{request:function(a){return a.headers=a.headers||{},c.sessionStorage.token&&(a.headers.Authorization="JWT "+c.sessionStorage.token),a},response:function(a){return 401===a.status,a||b.when(a)}}}]),angular.module("ratingClient").controller("RatinglistCtrl",["$scope","$routeParams","$http","baseUrl",function(a,b,c,d){a.gameType=b.gameType,a.model={ratingList:[]};var e=d+"/ratinglist/"+a.gameType+"/";c.get(e).success(function(b){a.model.ratingList=b})}]),angular.module("ratingClient").controller("PlayersCtrl",["$scope","$http","baseUrl",function(a,b,c){a.model={players:[]};var d=c+"/players/";b.get(d).success(function(b){a.model.players=b})}]),angular.module("ratingClient").controller("PlayerdetailsCtrl",["$scope","$http","baseUrl","$routeParams",function(a,b,c,d){a.model={player:{}};var e=c+"/players/"+d.playerId+"/";b.get(e).success(function(b){a.model.player=b})}]);